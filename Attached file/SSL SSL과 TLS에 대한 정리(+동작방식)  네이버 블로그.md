**\[SSL 및 TLS란?\]**

**SSL** - Secure Sockets Layer (Netscape 사에서 개발)

**TLS** - Transport Layer Security (IETF 사에서 개발)



**SSL**과 **TLS**는 **사용자와 웹 브라우저 간 통신을 암호화하는데 사용하는 프로토콜**입니다.



**TLS**은 **SSL**에서 개선된 신규 모델 프로토콜이라 생각하면 됩니다.



이를 위해서는 **SSL 인증서**를 통해 상호간의 암호화 통신을 만들어내며, 인증서에 포함된 웹 서버의 공개키를 바탕으로 상호간의 키 교환/공유를 통해 암호화 통신을 이끌어 냅니다.

(공개 키와 개인 키를 교환하여 보안 세션을 생성한 후 통신을 암호화합니다.)



**SSL 인증서**는 제 3의 신뢰 기관에서의 인증을 바탕으로 만들어지며, **SSL 인증서**에는 **인증서 용도 / 유효기간 / 발행기관 / 소유자 정보 / 공개 키** 등이 포함되어 있습니다.



전자 상거래가 활발해지며 웹 보안이 매우 중요해지고 있기에 개인정보보호 의무조치에 의해 개인정보 전송구간에 보안서버를 적용하도록 하고 있습니다.



**\[기존 SSL 및 TLS 동작방식\]**



1.  **TCP 3 Way Handshake**
    
2.  **클라이언트**는 **서버**에게 지원 가능한(암호, 키교환, 서명, 압축) 방식을 **서버**에게 알려준다.**(Client Hello)**
    
3.  **서버**는 **클라이언트**에게 지원 가능한(암호, 키교환, 서명, 압축) 방식을 응답해준다. **(Server Hello)**
    
4.  **서버**는 <u><b>공개키(RSA 암호용)</b></u>가 포함된 **서버 인증서**를 **클라이언트**에게 발송한다. **(Certificate Message)**
    
5.  (만약 **서버**가 **클라이언트 인증서**를 요구할 때 이에 대한 요청도 함께 함께 발송한다.) <- **선택사항**
    
6.  **\[Optional\]** 2.과 3.사이에 옵션으로, **클라이언트**가 **서버**에게 인증하기 위한 Client Certificate전송 과정이 포함될 수 있다.
    
7.  ID와 패스워드를 이용한 로그인이 아닌 <u>SSL 인증서를 통한 로그인</u>을 지원하는 웹 사이트에 로그인하기 위해서는 브라우저에 인증서를 등록해 두어야 하는데, 이 때 이 등록해둔 SSL 인증서가 **서버**로 전송된다.
    
8.  **서버**의 3번의 전송이 끝나면 **Server Hello Done** 메세지를 전달
    
9.  (**서버**가 **클라이언트** **인증서**를 요구할 경우) 인증서를 **서버**로 전송한다.**(3번 Optional 선택사항 해당하는 경우)**
    
10.  **클라이언트**는 **전송받은 서버 인증서**에 대해 브라우저에 내장된 신뢰기관으로부터 발급 여부를 확인한 후 (이 과정은 기간이 유효한지 ,
    
11.  해당 서버에서 발급된 인증서인지 유무 확인 등을 포함한다.) **세션키**로 사용될 **Pre-Master Key****(후 : 세션키(대칭키))**를 랜덤으로 생성하여 <u><b>공개키</b></u>로 암호화해 **서버**로 전송한다. 이 때, **ClientKeyExchange** 메세지에 암호화된 **Pre-Master Key****(후 : 세션키(대칭키))**가 포함된다.
    
12.  **서버**는 **자신의 개인키**로 **클라이언트**에게 전송받은 암호화된 **Pre-Master Key****(후 : 세션키(대칭키))**를 복호화한다.
    
13.  **서버**와 **클라이언트**는 일련의 과정을 거쳐 다음과 같은 순으로 (**Pre-Master Key -> Master Key -> 세션키**) **세션키**를 획득한다. 또한, **세션키**를 **대칭키** 방식으로 이용한다.
    
14.  (SSL의 보안 통신에서 사용되는 Key는 대칭키입니다. 즉, Client 및 Server에서 각각 계산해서 생성한 Key들은 양측이 같은 값을 갖게 됩니다.)
    
15.  **서버**는 협상과정에서 전송된 모든 메시지에 대하여(암호, 키교환, 서명, 압축)방식을 다음부터 적용할 것을 알리는 종결 메세지를 발송한 후 데이터 전송단계로 이동한다.
    
16.  **클라이언트****는 협상 과정에서 전송된 모든 메시지에 대하여(암호, 키교환, 서명, 압축) 방식을 다음부터 적용할 것을 알리는 종결 메시지를 발송한 후** 데이터 전송단계로 이동한다.
    
17.  이렇게 서로에게 **ChangeCipherSpec** 메세지를 보내 앞으로 모든 통신 내용은 **세션키(대칭키)**를 이용해 암호화해 보낼 것을 알려준다.
    
18.  여기까지 모두 정상적으로 완료된다면, **클라이언트**와 **서버** 모두 동일한 **세션키(대칭키)**를 공유하게 되는 것이다.
    
19.  앞 단계에서 서로 공유된 **세션키(대칭키)**를 이용한 암호화된 전송과정이 시작된다.
    
20.  통신이 끝나면 **세션키**는 폐기한다.
    



-   <u>위 내용 중, 기본적으로 </u> <u><b>클라이언트</b></u><u>가 선으로 SSL통신을 요청하여 </u> <u><b>클라이언트</b></u> <u> | </u> <u><b>서버</b></u> <u> 양단에서 SSL통신이 이루어지지만,</u>
    
-   2개가 세션을 맺지않고(미러방식 등, SW에서 복사된 패킷만 받는 경우) **서버**에서 전달받은 **인증서(공개키 포함)**을 **클라이언트**에 적용하고 **클라이언트**는 **임의의 세션키**를 만들고 **공개키**로 암호화시킨 후, **서버**에게 전달하여 강제적으로 SSL통신을 하도록해서 복호화를 유도하는 경우도 있습니다.
    
-   인증서는 최초에 SSL통신을 맺을때만 사용되고 SSL Session이 맺고 난 이후에는 인증서의 역할은 없습니다. (맺은 세션이 끊기기 전까지)
    





**\[신규 TLSv1.3버전 동작 방식\]**



작성할것~







**\[SSL(TLS)의 History \]**

-   **SSLv1.0**
    
-   대중에게 알려지지 않음.
    
-   **SSLv2.0**
    
-   1995년에 배포되었으나 보안 취약점 이슈가 있어 3.0 버전으로 개선됨.
    
-   **SSLv3.0**
    
-   v2.0에서 개선된 버전으로 1996년 배포되었으며 보안 이슈가 해결된 이후, TLSv1.0의 기초가 됨.
    
-   **TLSv1.0**
    
-   1999년 새 버전의 SSL으로 도입되며 SSLv3.0을 기반으로 함. 차이는 많이 없으나 TLSv1.0과 SSLv3.0은 상호 운용이 되지 않음을 확인해야함.
    
-   (IETF(Internet Engineering Task Force)에 의해 SSLv2.0, 3.0이 2011년 2015년 사용이 중지가 됨)
    
-   SSLv3.0의 취약점이 거의 해결되었으며, SHA1 알고리즘이 주로 사용되지만 SHA256도 지원하고 있다.(XP, vista에서 마지막으로 지원됨)
    
-   **TLSv1.1**
    
-   2006년 4월에 공개됨. 블록 체인공격에 대한 방어와 IANA 등록 파라메터 지원이 추가됨. 대부분의 브라우저 벤더들은 2020년까지 TLS 1.0과 1.1의 지원을 중단하기로 함. Chrome 역시 81버전에서 지원을 삭제할 예정.
    
-   **TLSv1.2**
    
-   2008년 8월에 배포됨. 취약한 SHA1 해싱 알고리즘을 완전이 버리고 SHA256만을 사용하도록 변경됨. 현재 네이버 등의 포털 사이트에서 지원.
    
-   보안이 강화될 수록 느리다는 단점이 있는데 TLS1.2가 이에 해당함.
    
-   **TLSv1.3**
    
-   2018년 8월 RFC 8446으로 게시가 됨. 최초 연결(handshaking) 시 개시하는 절차를 간소화시킴. (왕복 2회->1회)
    
-   또한, 0-RTT(Zero Round Trip Time Resumption) 기능으로 사이트 방문자의 연결 속도를 향상시킴.
    
-   TLSv1.2 버전이 아직 안전하기에 당장 업그레이드할 필요는 없지만 SNI 필드 암호화 확장 규격까지 합치면 평문으로 전송되는 부분이 아예 없어지기 때문에 인터넷 검열에 대항하는 사이트들은 업데이트를 서두를 예정. SNI 필드에 대해 암호화 규격이 들어갈 예정이 었으나 표준에는 포함되지 않았고, TLS 1.3 확장 기능으로써 Apple, Mozilla, Cloudflare, Fastly가 함께 Enctypted SNI(ESNI)에 관한 초안을 게시함)
    
-   취약한 암호 알고리즘에 대한 다음 9가지를 지원 중단함.
    
-   (RC4, RSA, SHA-1, CBC Mode Ciphers, MD5, Various Diffie-Hellman groups, DES, 3DES, EXPRT-strength ciphers)
    





**\[추가 정보\]**

-   SSL은 IETF에 의해 사용 중지 되었기에 대부분의 최신 브라우저는 이전 프로토콜을 지원안하는 경우가 대부분입니다.
    
-   그렇기에 최신 브라우저에서 SSL의 사용은 환경이 저하될 우려가 있습니다. 그렇기에 SSL을 비활성화하고 TLS를 활성화하도록 하는 것이 좋습니다.
    
-   인증서와 프로토콜은 별개입니다. SSL 인증서를 TLS 인증서로 대체해야한다는 문제를 걱정할 필요가 없으며 의존하지 않는다는 것을 알아야 합니다. 프로토콜은 인증서가 아니라 서버 구성에 따라 결정되므로 "SSL 및 TLS와 함께 사용할 인증서"라고 하는 것이 더 정확합니다.
    
-   SSL과 TLS은 단순히 클라이언트와 서버간에 발생하는 Handshake를 나타내는 것이 아니며, 암호화 자체를 수행하지 않습니다.
    
-   공유되는 비밀 및 사용될 암호화 유형을 결정하는 절차를 진행하는 것입니다.
    
-   SSL 프로토콜이 지원하는지 확인하기 위해 SSL 서버 테스트를 사용하여 확인 가능합니다.
    



**\[레퍼런스\]**

[https://ideatec.co.kr/SSL\_view/?](https://ideatec.co.kr/SSL_view/?q=YToxOntzOjEyOiJrZXl3b3JkX3R5cGUiO3M6MzoiYWxsIjt9&bmode=view&idx=5796632&t=board)

[https://namu.wiki/w/TLS#s-1.3.5](https://namu.wiki/w/TLS#s-1.3.5)

[https://soul0.tistory.com/416](https://soul0.tistory.com/416)

(와이어샤크 대조, 각 요청문장에 대해 설명)

[https://darksoulstory.tistory.com/57](https://darksoulstory.tistory.com/57)

[https://hanjungv.github.io/2017-11-07-1\_CS\_SSL/](https://hanjungv.github.io/2017-11-07-1_CS_SSL/)

[https://www.tuwlab.com/ece/26967](https://www.tuwlab.com/ece/26967)

[https://b.luavis.kr/server/tls-1.3](https://b.luavis.kr/server/tls-1.3)

[https://m.blog.naver.com/PostView.nhn?](https://m.blog.naver.com/PostView.nhn?blogId=ucert&logNo=221181214090&proxyReferer=https%3A%2F%2Fwww.google.com%2F)

[https://waspro.tistory.com/161](https://waspro.tistory.com/161)

[https://smartits.tistory.com/209](https://smartits.tistory.com/209)

[http://www.itworld.co.kr/news/113007](http://www.itworld.co.kr/news/113007)

